/** https://github.com/FreyYKT/datamatrix-svg under MIT license */
"use strict";function DATAMatrix($){var _=[],r=0,e=0,t=function($,r){_[r]=_[r]||[],_[r][$]=1},n=function($){var _={FNC1:232,GS:30},r=[];let e,t=/<(FNC1|GS)>/g;for(;null!==(e=t.exec($));)r.push(Object.assign(e));var n=[];for(var f in r)n.push(r[f].index);for(var o=[],i=$.length,h=0;h<i;h++){var s=n.indexOf(h);if(s>=0){var f=r[s][1];_.hasOwnProperty(f)&&(o.push(_[f]),h=h+f.length+1)}else{var u=$.charCodeAt(h),a=h+1<i?$.charCodeAt(h+1):0;u>47&&u<58&&a>47&&a<58?(o.push((u-48)*10+a+82),h++):u>127?(o.push(235),o.push(u-127&255)):o.push(u+1)}}return o},f=function($){var _=[231],r=$.length;250<r&&_.push(37+(r/250|0)&255),_.push(r%250+149*(_.length+1)%255+1&255);for(var e=0;e<r;e++)_.push($.charCodeAt(e)+149*(_.length+1)%255+1&255);return _},o=function($){for(var _,r=$.length,e=r+1&-4,t=0,f=e>0?[240]:[],o=0;o<e;o++){if(o<e-1){if((_=$.charCodeAt(o))<32||_>94)return[]}else _=31;t=64*t+(63&_),(3&o)==3&&(f.push(t>>16),f.push(t>>8&255),f.push(255&t),t=0)}return e>r?f:f.concat(n($.substr(0==e?0:e-1)))},i=function($,_){var r,e,t=0,f=0,o=$.length,i=[_[0]],h=function($){f=40*f+$,2==t++&&(i.push(++f>>8),i.push(255&f),t=f=0)};for(r=0;r<o&&(0!=t||r!=o-1);r++){var s=$.charCodeAt(r);for(s>127&&238!=i[0]&&(h(1),h(30),s-=128),e=1;s>_[e];e+=3);var u=_[e+1];if(8==u||9==u&&0==t&&r==o-1)return[];if(u<5&&2==t&&r==o-1)break;u<5&&h(u),h(s-_[e+2])}return 2==t&&238!==i[0]&&h(0),i.push(254),(t>0||r<o)&&(i=i.concat(n($.substr(r-t)))),i},h=function($,_){$=unescape(encodeURI($));var h=n($),s=h.length,u=i($,[230,31,0,0,32,9,29,47,1,33,57,9,44,64,1,43,90,9,51,95,1,69,127,2,96,255,1,0]),a=u.length;a>0&&a<s&&(h=u,s=a),(a=(u=i($,[239,31,0,0,32,9,29,47,1,33,57,9,44,64,1,43,90,2,64,95,1,69,122,9,83,127,2,96,255,1,0])).length)>0&&a<s&&(h=u,s=a),(a=(u=i($,[238,12,8,0,13,9,13,31,8,0,32,9,29,41,8,0,42,9,41,47,8,0,57,9,44,64,8,0,90,9,51,255,8,0])).length)>0&&a<s&&(h=u,s=a),(a=(u=o($)).length)>0&&a<s&&(h=u,s=a),(a=(u=f($)).length)>0&&a<s&&(h=u,s=a);var l,p,v,c,g,d,w,C,A=1,m=1,x=-1,b=1,M=Array(70),N=Array(70),S=Array(256),y=Array(255);if(_&&s<50){u=[16,7,28,11,24,14,32,18,32,24,44,28];do a=(p=u[++x])*(l=6+(12&x))/8;while(a-u[++x]<s);p>25&&(A=2)}else{p=l=6,g=2,u=[5,7,10,12,14,18,20,24,28,36,42,48,56,68,84,112,144,192,224,272,336,408,496,620];do{if(++x==u.length)return[0,0];p>11*g&&(g=4+g&12),a=(p=l+=g)*l>>3}while(a-u[x]<s);p>27&&(m=A=2*(p/54|0)+2),a>255&&(b=2*(a>>9)+2)}for(C=u[x],v=p/A,c=l/m,s<a-C&&(h[s++]=129);s<a-C;)h[s++]=(149*s%253+130)%254;for(C/=b,x=1,g=0;g<255;g++)y[g]=x,S[x]=g,(x+=x)>255&&(x^=301);for(M[C]=0,g=1;g<=C;g++)for(M[x=C-g]=1;x<C;x++)M[x]=M[x+1]^y[(S[M[x]]+g)%255];for(d=0;d<b;d++){for(g=0;g<=C;g++)N[g]=0;for(g=d;g<s;g+=b)for(x=0,z=N[0]^h[g];x<C;x++)N[x]=N[x+1]^(z?y[(S[M[x]]+S[z])%255]:0);for(g=0;g<C;g++)h[s+d+g*b]=N[g]}for(g=0;g<l+2*m;g+=c+2)for(x=0;x<p+2*A;x++)t(x,g+c+1),(1&x)==0&&t(x,g);for(g=0;g<p+2*A;g+=v+2)for(x=0;x<l;x++)t(g,x+(x/c|0)*2+1),(1&x)==1&&t(g+v+1,x+(x/c|0)*2);for(C=2,d=0,w=4,b=[0,0,-1,0,-2,0,0,-1,-1,-1,-2,-1,-1,-2,-2,-2],g=0;g<a;w-=C,d+=C){if(w==l-3&&-1==d)u=[p,6-l,p,5-l,p,4-l,p,3-l,p-1,3-l,3,2,2,2,1,2];else if(w==l+1&&1==d&&(7&p)==0&&(7&l)==6)u=[p-2,-l,p-3,-l,p-4,-l,p-2,-1-l,p-3,-1-l,p-4,-1-l,p-2,-2,-1,-2];else{if(0==w&&d==p-2&&3&p)continue;if(w<0||d>=p||w>=l||d<0)for(w+=2+(C=-C)/2,d+=2-C/2;w<0||d>=p||w>=l||d<0;)w-=C,d+=C;if(w==l-2&&0==d&&3&p)u=[p-1,3-l,p-1,2-l,p-2,2-l,p-3,2-l,p-4,2-l,0,1,0,0,0,-1];else if(w==l-2&&0==d&&(7&p)==4)u=[p-1,5-l,p-1,4-l,p-1,3-l,p-1,2-l,p-2,2-l,0,1,0,0,0,-1];else{if(1==w&&d==p-1&&(7&p)==0&&(7&l)==6)continue;u=b}}for(s=h[g++],x=0;s>0;x+=2,s>>=1)if(1&s){var z=d+u[x],E=w+u[x+1];z<0&&(z+=p,E+=4-(p+4&7)),E<0&&(E+=l,z+=4-(l+4&7)),t(z+2*(z/v|0)+1,E+2*(E/c|0)+1)}}for(g=p;3&g;g--)t(g,g);r=p+2*A,e=l+2*m};return function(){function t($){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test($)}function n($,_){for(var r in $=document.createElementNS(p,$),_||{})$.setAttribute(r,_[r]);return $}var f,o,i,s,u,a,l=Math.abs,p="http://www.w3.org/2000/svg",v="",c="string"==typeof $?{msg:$}:$||{},g=c.pal||["#000"],d=l(c.dim)||256,w=l(c.pad),w=w>-1?w:2,C=[1,0,0,1,w,w],A=g[0],A=t(A)?A:"#000",m=g[1],m=t(m)?m:0,x=c.vrb?0:1;for(h(c.msg||"",c.rct),u=r+2*w,a=e+2*w,i=e;i--;)for(s=0,o=r;o--;)_[i][o]&&(x?(s++,_[i][o-1]||(v+="M"+o+","+i+"h"+s+"v1h-"+s+"v-1z",s=0)):v+="M"+o+","+i+"h1v1h-1v-1z");return f=n("svg",{viewBox:[0,0,u,a].join(" "),width:d/a*u|0,height:d,fill:A,"shape-rendering":"crispEdges",xmlns:p,version:"1.1"}),m&&f.appendChild(n("path",{fill:m,d:"M0,0v"+a+"h"+u+"V0H0Z"})),f.appendChild(n("path",{transform:"matrix("+C+")",d:v})),f}()}
